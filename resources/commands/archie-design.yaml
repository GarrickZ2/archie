title: Design
description: Gather technical requirements and produce design artifacts
tags: [design, architecture, artifacts]
category: Archie
content: |
  Gather technical requirements through dialogue and produce design artifacts.

  ## Guard Check
  - Status MUST be: `READY_FOR_DESIGN`, `UNDER_DESIGN`
  - Required: features/<key>.md with completed requirements
  - If BLOCKED/NOT_REVIEWED → STOP, instruct `review` first

  ## Reads
  - background.md, glossary.md, features/<key>.md
  - api/api.md, storage.md, dependency.md, workflow/*, metrics.md

  ## Writes
  - api/api.md, api/<service>.thrift or .proto
  - storage.md, workflow/<key>/workflow.md, workflow/<key>/*.mmd
  - metrics.md, dependency.md (if changed)
  - features/<key>.md (Design Artifacts links, Status → DESIGNED)

  ## Workflow

  ### 1. Read Context
  Read existing docs, use glossary.md for consistent naming

  ### 2. Gather Architecture
  Ask until clear: actors, dependencies, service, API needs, storage needs, constraints
  Use glossary service/system names

  ### 3. Design Workflow (Interactive)
  Ask flow → generate diagrams → user approval

  ### 4. Design API (Interactive)
  Ask methods → generate IDL → user approval

  ### 5. Design Storage (Interactive)
  Ask tables → generate schema → user approval

  ### 6. Design Metrics (Interactive)
  Ask metrics → generate SLI/SLO → user approval

  ### 7. Write After Approval
  Write all artifacts, update features/<key>.md links, Status → DESIGNED

  ## AI Role
  Ask questions, record decisions, generate artifacts. User makes final decisions.

  ## Correction Behavior
  - Wrong status → STOP, instruct correct command
  - Info incomplete → keep asking
  - User uncertain → provide options
