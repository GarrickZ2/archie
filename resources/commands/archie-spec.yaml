title: Spec
description: Generate execution-ready coding specifications from design artifacts
tags: [specification, coding, execution]
category: Archie
content: |
  ### Purpose
  Generate a Coding Spec for implementation (agent-friendly, execution-focused).

  ### Allowed Status
  - `DESIGNED`

  ### Reads
  - `features/<feature-key>.md`
  - `api/api.md` + relevant `api/*.thrift`
  - `workflow/<feature-key>/*`
  - `storage.md`
  - `metrics.md`
  - `tasks.md`
  - `blocker.md`

  ### Writes
  - `spec/<feature-key>.spec.md`
  - `features/<feature-key>.md` (Spec section + status + changelog)

  ### Required Outputs
  - Spec contains: interfaces, data model, workflow, edge cases, observability, rollout, test plan.
  - `features/<feature-key>.md`:
      - `Spec.Location` points to the spec file
      - `Spec.Readiness` set to `READY`
      - Status set to `SPEC_READY`

  ### Correction Behavior
  If any design artifact is missing (API/storage/workflow/metrics/tasks):
  - Refuse to mark READY; create blockers listing missing artifacts; set status to `UNDER_DESIGN` or `BLOCKED`.

  ### Workflow

  #### Step 1: Validate Design Completeness
  - Check all required artifacts exist: API, workflow, storage, metrics
  - If any missing → create blockers, refuse to proceed

  #### Step 2: Generate Spec from Artifacts
  Derive spec sections deterministically:
  - **Interfaces**: from api/api.md and api/*.thrift
  - **Data Model**: from storage.md
  - **Workflow**: from workflow/<feature-key>/*.mmd and workflow.md
  - **Edge Cases**: from workflow failure paths
  - **Observability**: from metrics.md
  - **Test Plan**: from tasks.md or generate basic checklist
  - **Rollout**: from deployment considerations in background.md

  #### Step 3: Present Spec to User
  - Show generated spec with key sections highlighted
  - Ask user: "Does this spec capture all requirements? Any sections need revision?"

  #### Step 4: Handle User Feedback
  - If user requests changes: apply modifications and re-present
  - If user approves: proceed to write

  #### Step 5: Write Files After Approval
  - Write spec/<feature-key>.spec.md
  - Update features/<feature-key>.md:
    - Spec.Location → spec file path
    - Spec.Readiness → READY
    - Status → SPEC_READY
    - Changelog → record spec generation timestamp and readiness
  - Report completion summary
